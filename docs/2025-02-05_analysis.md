# 2025-02-05 项目分析与后续计划

## 核心问题

当前 Video → ECG 模型效果不理想，需要排查原因并制定后续实验计划。

---

## 1. 模型分析：是否为验证过的研究模型？

### 当前实现的模型来源

| Scheme | 模型类型 | 论文来源 | 原始任务 | 验证状态 |
|--------|----------|----------|----------|----------|
| C | MTTS-CAN | NeurIPS 2020 "Multi-Task Temporal Shift Attention Networks" | Video → rPPG | ✅ 学术验证 |
| D | 1D TCN | 通用架构 | - | ⚠️ 基础实现 |
| E | 1D UNet | 通用架构 | - | ⚠️ 基础实现 |
| F | EfficientPhys | WACV 2023 "EfficientPhys" | Video → rPPG | ✅ 学术验证 |
| G | PhysNet | BMVC 2019 "Remote Photoplethysmograph Signal Measurement" | Video → rPPG | ✅ 学术验证 |

### 关键发现

1. **学术来源模型 (C/F/G) 的设计目标是 Video → rPPG（心率/PPG波形），而非 PPG → ECG**
2. **ECG 重建是更难的任务**：PPG 和 ECG 虽然都反映心脏活动，但波形差异很大
   - PPG: 反映血容量变化，波形相对简单
   - ECG: 反映心电活动，包含 P波、QRS波群、T波等复杂形态
3. **当前实现可能是简化版本**：没有完全复现论文中的所有细节

### 文献调研：PPG → ECG 重建的最新进展

根据 2024-2025 年文献：
- [CLEP-GAN (2025)](https://link.springer.com/article/10.1186/s12859-025-06276-0): 结合对比学习+GAN实现跨用户 PPG→ECG
- [Hybrid Attention Network (2024)](https://link.springer.com/article/10.1186/s13634-024-01158-8): 混合注意力机制重建 ECG
- 关键：这些工作都是从 **1D PPG 信号** 重建 ECG，而非直接从视频

### 🔥 PPG → ECG 重建模型完整列表

#### ✅ 有开源代码的模型（推荐优先）

| 模型 | 论文/会议 | 架构 | 数据集 | 框架 | GitHub | 性能 |
|------|-----------|------|--------|------|--------|------|
| **CardioGAN** | AAAI 2021 | GAN + 双判别器 + 注意力 | BIDMC, CAPNO, DALIA, WESAD | TF 2.2 | [pritamqu/ppg2ecg-cardiogan](https://github.com/pritamqu/ppg2ecg-cardiogan) | 有预训练权重 |
| **PPG2ECG** | IEEE 2020 | Transformer + 注意力 | UQVIT, BIDMC | PyTorch 1.2 | [james77777778/ppg2ecg-pytorch](https://github.com/james77777778/ppg2ecg-pytorch) | 专注 QRS 重建 |
| **P2E-WGAN** | ACM SAC 2021 | WGAN-GP + 1D CNN | 自定义 | PyTorch | [khuongav/P2E-WGAN-ecg-ppg-reconstruction](https://github.com/khuongav/P2E-WGAN-ecg-ppg-reconstruction) | 端到端 |

#### ⚠️ 仅有论文的模型（需自行实现或联系作者）

| 模型 | 论文/会议 | 架构 | 数据集 | 性能指标 | 论文链接 |
|------|-----------|------|--------|----------|----------|
| **Performer** | WACV 2023 | Transformer (SPA) | BIDMC | RMSE=0.29 | [PDF](https://openaccess.thecvf.com/content/WACV2023/papers/Lan_Performer_A_Novel_PPG-to-ECG_Reconstruction_Transformer_for_a_Digital_Biomarker_WACV_2023_paper.pdf) |
| **CLEP-GAN** | BMC 2025 | 对比学习+GAN+VQ-VAE+注意力 | BIDMC, CapnoBase | SOTA 跨用户 | [Springer](https://link.springer.com/article/10.1186/s12859-025-06276-0) |
| **PPG2ECGps** | MDPI 2023 | W-Net (双U-Net) | MIMIC-II | r=0.988, RMSE=0.016mV | [MDPI](https://www.mdpi.com/2306-5354/10/6/630) |
| **HA-CNN-BiLSTM** | 2024 | ResNet+BiLSTM+注意力 | MIMIC | 混合架构 | [Springer](https://link.springer.com/article/10.1186/s13634-024-01158-8) |
| **Vision Transformer** | arXiv 2025 | ViT + 2D 信号图像 | BIDMC, CapnoBase | PRD降低29%/18% | [arXiv](https://arxiv.org/html/2505.21767v1) |
| **Bi-LSTM** | Frontiers 2022 | 双向 LSTM | 自定义 | r=0.94 (1秒窗口) | [Frontiers](https://www.frontiersin.org/journals/physiology/articles/10.3389/fphys.2022.859763/full) |

#### 🎬 Video → ECG 端到端工作（最相关！）

| 模型 | 论文/会议 | 输入 | 架构 | 数据集 | 代码 | 论文链接 |
|------|-----------|------|------|--------|------|----------|
| **Facial Video → ECG** | Knowledge-Based Systems 2023 | 6秒人脸视频 (180帧) | 显式+隐式监督 + 时空注意力 | UBFC, OBF, FaceBio | ❌ 无开源 | [ScienceDirect](https://www.sciencedirect.com/science/article/abs/pii/S0950705123003581) |
| **MCD-rPPG Baselines** | 2024 | 多角度人脸视频 | ResNet/ViT/Swin + POS/TS_CAN | MCD-rPPG (含ECG标注) | ✅ | [GitHub](https://github.com/garrulus2003/MCD-rPPG-baselines) |

> ⚠️ **注意**：目前 Video → ECG 的端到端工作很少，大多数是 Video → rPPG → ECG 两阶段方法

#### 🔗 rPPG vs PPG vs Video 的关系（重要澄清！）

```
⚠️ 关键：rPPG ≠ 视频，rPPG 是从视频【提取出来】的 1D 信号

处理流程：
┌─────────────┐      ┌─────────────┐      ┌─────────────┐
│   Video     │ ──▶  │  rPPG/PPG   │ ──▶  │    ECG      │
│ (RGB frames)│      │ (1D signal) │      │ (1D signal) │
└─────────────┘      └─────────────┘      └─────────────┘
                 ↑                    ↑
          EfficientPhys        CardioGAN
          PhysNet 等           PPG2ECG 等

- PPG → ECG 和 rPPG → ECG 用【同样的模型】（都是 1D→1D）
- Video → ECG 端到端：目前只有 KBS 2023 那篇，但没开源
- 我们的数据（手指视频）：血管比人脸更明显，理论上信号更强
```

**实施策略（已讨论确认）**：
1. **首选 PPG2ECG-PyTorch**：先在我们数据上快速试
   - 从视频提取绿色通道均值作为 PPG
   - 如果失败，再去 BIDMC 公开数据集排查
2. 如果简单提取的 PPG 不够好，用 rPPG-Toolbox 提取
3. 最后考虑端到端 Video → ECG

#### 🆕 新兴方向

| 方向 | 说明 | 参考 |
|------|------|------|
| **GPT-PPG** | GPT-based PPG 基础模型，可迁移到多种下游任务 | [arXiv 2025](https://arxiv.org/html/2503.08015v1) |
| **Transformer for Biosignals** | Transformer 在生物信号分析中的综述 | [Information Fusion 2024](https://dl.acm.org/doi/10.1016/j.inffus.2024.102697) |
| **Radar → ECG** | 从雷达信号重建 ECG | [ScienceDirect 2024](https://www.sciencedirect.com/science/article/abs/pii/S0010482524006395) |

#### 📚 相关资源

| 资源 | 说明 | 链接 |
|------|------|------|
| **awesome-ppg** | PPG 相关资源汇总（论文、数据集、工具） | [GitHub](https://github.com/mintisan/awesome-ppg) |
| **rPPG-Toolbox** | 远程 PPG 工具箱，含 EfficientPhys/PhysNet 等 | [GitHub](https://github.com/ubicomplab/rPPG-Toolbox) |
| **pyVHR** | Python 视频心率估计框架 | [GitHub](https://github.com/phuselab/pyVHR) |
| **DL_PPG_Review** | PPG 深度学习综述配套代码 | [GitHub](https://github.com/Ngk03/DL_PPG_Review) |

**推荐优先尝试**：
1. **CardioGAN** - 4 个公开数据集验证，代码完整，有预训练权重，TensorFlow
2. **PPG2ECG-PyTorch** - PyTorch 实现，专注 QRS 复合波重建
3. **P2E-WGAN** - 端到端 PyTorch，WGAN 架构

### 待办：模型验证实验

| 实验 | 目的 | 方法 |
|------|------|------|
| **A1** | 复现 SOTA | 跑通 CardioGAN / PPG2ECG 在 BIDMC 上的结果 |
| **A2** | 迁移到我们的数据 | 用验证过的模型架构替换当前 Scheme E |
| **A3** | 简化任务验证 | 只预测心率（标量），而非完整 ECG 波形 |
| **A4** | 分步验证 | Video → PPG → ECG 两阶段，分别验证 |

---

## 2. 数据质量分析：视频压缩是否过度？

### 当前数据统计

| 指标 | 值 | 问题 |
|------|-----|------|
| 平均码率 | ~275 kbps | 🔴 极低，2分钟视频仅 4MB |
| 模型输入分辨率 | 36×36 / 64×64 | 🟡 可能丢失细节 |
| 视频帧率 | 30 fps | 🟢 正常 |
| PPG质量 good | 80/98 (81.6%) | 🟡 10个样本完全无效 |

### 视频压缩对 PPG 提取的影响

1. **亮度量化误差**：PPG 依赖皮肤微小亮度变化（通常 <1% 像素值变化）
   - 高压缩会丢失这些微弱信号
   - H.264 的 DCT 变换会模糊空间细节
2. **码率 275kbps 意味着**：
   - 每帧仅 ~1.1KB 的数据
   - 原始 36×36×3 = 3.8KB，压缩比 ~3.5:1
   - 原始 64×64×3 = 12KB，压缩比 ~11:1 🔴

### 理论分析

```
PPG 信号的典型特征：
- 幅度：1-2% 的像素值变化
- 红色通道变化范围（从CSV）：平均 red_range = 15.3，相对于 0-255 约 6%
- 但视频压缩会引入 ±2-5 的量化噪声，可能淹没信号
```

### 待办：数据质量验证实验

| 实验 | 目的 | 方法 |
|------|------|------|
| **B1** | 高质量视频对比 | 用新采集的高质量视频重新训练 |
| **B2** | 原始帧 vs 压缩帧 | 若有原始帧，比较 PPG 提取质量 |
| **B3** | 不同压缩等级 | 测试不同 CRF 值对 PPG 信号的影响 |

---

## 3. 任务难度分析：ECG 重建是否可行？

### 理论基础

```
Video (30fps, RGB)
    ↓ 提取皮肤亮度变化
PPG (30 Hz, 反映血容量)
    ↓ 生理映射（需要学习）
ECG (250 Hz, 反映心电活动)
```

### 核心挑战

| 挑战 | 描述 | 严重程度 |
|------|------|----------|
| **采样率不匹配** | 30fps 视频 → 250Hz ECG（8.3倍上采样） | 🔴 高 |
| **信息不对等** | PPG 不包含 ECG 的全部信息（如 P波形态） | 🔴 高 |
| **个体差异** | PTT (脉搏传导时间) 因人而异 | 🟡 中 |
| **数据量小** | 98 样本 / 10 用户 | 🟡 中 |

### 关于 ECG 降采样

**问题**：是否应该将 ECG 目标降到更低采样率（如 125Hz 或 30Hz）？

**分析**：
- 250Hz → 125Hz: 保留大部分 QRS 细节，Nyquist 频率 62.5Hz 仍足够
- 250Hz → 30Hz: 丢失 QRS 波群的快速上升沿，但心率信息保留
- **建议**：作为消融实验，尝试 125Hz 和 62.5Hz 目标，观察模型是否更容易学习

### 简化任务路线

```
Level 1 (最简单): Video → Heart Rate (标量)
Level 2: Video → PPG 波形 (30Hz)
Level 3: Video → ECG 包络 (30Hz，只保留 R 峰位置)
Level 4: Video → ECG 波形 (125Hz)
Level 5 (最难): Video → ECG 波形 (250Hz) ← 当前任务
```

**建议**：先验证 Level 1-3，确认模型能学到东西，再逐步提升难度。

---

## 4. 多模态融合：IMU + 音频

### IMU 数据的潜在价值

| 信号 | 可能包含的信息 | 对 ECG 重建的帮助 |
|------|----------------|-------------------|
| 加速度计 | 手指运动、呼吸、心冲击波 (BCG) | 🟢 可补充心跳节律信息 |
| 陀螺仪 | 手指微颤 | 🟡 间接反映心脏活动 |

### 音频数据的潜在价值

⚠️ **当前数据集未采集音频**

如果采集：
- 心音 (S1/S2) 可提供心脏瓣膜活动的精确时刻
- 对于定位 QRS 波群的起始点非常有价值
- 但需要高质量麦克风和贴近胸口

### 待办：多模态实验

| 实验 | 目的 | 方法 |
|------|------|------|
| **C1** | IMU 单独建模 | 仅用 IMU 预测心率，验证信号质量 |
| **C2** | Video + IMU 融合 | 在现有方案上开启 `use_imu: true` |
| **C3** | 音频可行性 | 分析是否需要采集音频数据 |

---

## 5. 交叉验证方案：排除数据 vs 模型问题

### 设计矩阵

|  | 公开数据集 | 自有数据集 |
|--|-----------|-----------|
| **我们的模型** | 实验 X1：验证模型架构 | 实验 X2：当前状态 |
| **SOTA 模型** | 实验 X3：Baseline 对比 | 实验 X4：验证数据可用性 |

### 具体实验计划

**实验 X1**：我们的模型 + BIDMC 数据集
- 目标：验证模型架构是否正确
- 方法：下载 [BIDMC PPG and Respiration Dataset](https://physionet.org/content/bidmc/1.0.0/)（125Hz PPG+ECG，53个8分钟记录）
- 预期：如果 PPG→ECG 在 BIDMC 上有效，说明模型架构没问题

**实验 X2**：当前实验（已进行）
- 结果：效果不理想

**实验 X3**：SOTA 模型 + 公开数据集
- 目标：获取 Baseline
- 方法：复现 [CLEP-GAN](https://link.springer.com/article/10.1186/s12859-025-06276-0) 或类似工作
- 预期：了解 SOTA 能达到什么水平

**实验 X4**：SOTA 模型 + 自有数据集
- 目标：验证数据质量是否足够
- 方法：用验证过的 SOTA 架构在我们的数据上训练
- 预期：如果 SOTA 也失败，说明是数据问题

---

## 6. 项目整体规划（2025-02-05 讨论确定）

### 核心问题：信息压缩 vs 端到端

```
⚠️ 用户担心：直接取通道均值会不会信息压缩太多？

三种路线对比：
┌─────────────────────────────────────────────────────────────────────┐
│ 路线 A: Video → 均值提取 PPG → PPG2ECG → ECG                        │
│         🔴 信息压缩严重，但验证 PPG→ECG 是否可行                     │
│                                                                     │
│ 路线 B: Video → EfficientPhys/PhysNet → rPPG → PPG2ECG → ECG       │
│         🟡 神经网络提取 rPPG，保留更多信息                           │
│                                                                     │
│ 路线 C: Video → 端到端模型 → ECG                                    │
│         🟢 信息保留最多，但没有现成的验证过的开源模型                 │
│         我们的 Scheme C/F/G 就是这个路线，但设计目标是 rPPG 不是 ECG  │
└─────────────────────────────────────────────────────────────────────┘

结论：需要多条路线并行验证
```

### 项目整体规划

```
Phase 1: 验证 PPG → ECG 是否可行
├── 1.1 PPG2ECG 在我们数据上（路线 A 快速验证）
├── 1.2 PPG2ECG 在 BIDMC 上（排查模型问题）
└── 1.3 CardioGAN 备选（有预训练权重）

Phase 2: 验证 Video → rPPG 是否足够好
├── 2.1 用 rPPG-Toolbox 的 EfficientPhys 提取 rPPG
├── 2.2 对比简单均值 vs 神经网络提取的 rPPG 质量
└── 2.3 rPPG + PPG2ECG 组合（路线 B）

Phase 3: 端到端 Video → ECG（路线 C）
├── 3.1 改造 Scheme F/G，目标从 rPPG 改为 ECG
├── 3.2 参考 KBS 2023 论文实现端到端模型
└── 3.3 多模态融合（IMU、音频）

Phase 4: 排查数据/任务问题
├── 4.1 高质量视频重采集
├── 4.2 ECG 降采样（125Hz/62.5Hz）降低任务难度
└── 4.3 简化任务：先预测心率，再预测波形
```

### 实验执行顺序（按优先级）

| 顺序 | 实验 | 目的 | 预期时间 |
|------|------|------|----------|
| **1** | PPG2ECG + 我们数据（均值提取） | 快速验证 PPG→ECG 可行性 | Session 1 |
| **2** | PPG2ECG + BIDMC | 排查模型 vs 数据问题 | Session 1-2 |
| **3** | CardioGAN + 我们数据 | 备选方案验证 | Session 2 |
| **4** | EfficientPhys 提取 rPPG | 验证神经网络提取是否更好 | Session 3 |
| **5** | rPPG + PPG2ECG 组合 | 路线 B 完整验证 | Session 3 |
| **6** | 改造 Scheme F 为 Video→ECG | 路线 C 端到端 | Session 4 |
| **7** | ECG 降采样实验 | 排查任务难度 | Session 4-5 |
| **8** | IMU/音频融合 | 多模态增强 | Session 5+ |

### 判断逻辑

```
如果 实验1 成功 → 路线 A 可行，继续优化
如果 实验1 失败 + 实验2 成功 → 数据问题，需改进数据
如果 实验1 失败 + 实验2 失败 → 模型问题，换 CardioGAN

如果 实验4 比 实验1 好很多 → 均值提取丢失太多信息
如果 实验4 和 实验1 差不多 → 瓶颈不在 PPG 提取

如果 路线 A/B 都失败 + 路线 C 成功 → 需要端到端学习
如果 路线 A/B/C 都失败 → 任务本身太难 or 数据质量不足
```

---

## 7. 关键问题清单

### 需要回答的问题

| # | 问题 | 如何验证 | 当前状态 |
|---|------|----------|----------|
| Q1 | 模型架构是否正确？ | 在 BIDMC 上训练 | ⏳ 待验证 |
| Q2 | 视频压缩是否过度？ | 对比高/低质量视频 | ⏳ 待新数据 |
| Q3 | 30fps→250Hz 是否可行？ | 尝试降低 ECG 采样率 | ⏳ 待实验 |
| Q4 | PPG 和 ECG 相关性如何？ | 可视化分析 | ⏳ 待分析 |
| Q5 | IMU 能否提供额外信息？ | IMU-only 心率预测 | ⏳ 待实验 |

### 判断依据

- **如果 Q1 通过**：模型架构 OK，问题在数据
- **如果 Q1 失败**：需要更好的模型架构
- **如果 Q3 通过**：降采样是可行的妥协方案
- **如果 Q5 通过**：多模态融合值得投入

---

## 8. 资源链接

### 公开 PPG-ECG 数据集（用于验证模型）

| 数据集 | 采样率 | 样本量 | 信号 | 链接 |
|--------|--------|--------|------|------|
| **BIDMC** | 125 Hz | 53×8分钟 | PPG+ECG+呼吸 | [PhysioNet](https://physionet.org/content/bidmc/1.0.0/) |
| **MIMIC-II/III** | 125 Hz | 12000+ 记录 | PPG+ECG+ABP | [PhysioNet](https://physionet.org/content/mimic3wdb/1.0/) |
| **CapnoBase** | 300 Hz | 42×8分钟 | PPG+ECG+CO2 | [CapnoBase](http://www.capnobase.org/) |
| **PPG-DaLiA** | 64 Hz | 15人×2.5h | PPG+ECG+运动 | [UCI](https://archive.ics.uci.edu/ml/datasets/PPG-DaLiA) |
| **WESAD** | 700/64 Hz | 15人 | PPG+ECG+多模态 | [UCI](https://archive.ics.uci.edu/ml/datasets/WESAD) |
| **UQVIT** | 100 Hz | - | PPG+ECG | 需申请 |

> **推荐**：先用 BIDMC（最常用 benchmark），数据量适中，下载方便

### 参考论文

- [CLEP-GAN (2025)](https://link.springer.com/article/10.1186/s12859-025-06276-0) - 跨用户 PPG→ECG
- [Hybrid Attention ECG Reconstruction (2024)](https://link.springer.com/article/10.1186/s13634-024-01158-8)
- [EfficientPhys (WACV 2023)](https://arxiv.org/abs/2110.04447) - Video→rPPG
- [MTTS-CAN (NeurIPS 2020)](https://proceedings.neurips.cc/paper/2020/file/e1228be46de6a0234ac22ded31417bc7-Paper.pdf)

---

## 9. 复现承诺与注意事项

### ⚠️ 论文复现原则

**承诺**：如果省略了论文中的细节，会明确告知，不会声称完全复现。

### PPG2ECG-PyTorch 复现要点

根据 [GitHub README](https://github.com/james77777778/ppg2ecg-pytorch)：

| 项目 | 要求 | 备注 |
|------|------|------|
| 输入采样率 | 100 Hz | 需从 30fps 视频重采样 |
| 窗口长度 | 2 秒 (200 点) | - |
| 输入 shape | `[batch, 1, 200]` | 单通道 |
| 数据范围 | [-1, 1] | 需归一化 |
| 模型架构 | Transformed Attentional NN | 需检查是否完整实现 |

### 需要检查的细节

- [ ] 损失函数：论文用的是什么 loss？
- [ ] 学习率和优化器配置
- [ ] 数据增强策略
- [ ] PPG/ECG 对齐方式（是否需要 PAT 校正）
- [ ] 评估指标的计算方式

---

## 10. 空间信息与多模态讨论（2025-02-05 追加）

### 10.1 视频空间信息的潜在价值

**问题**：直接取通道均值会不会丢失太多信息？手指视频中的空间信息是否有用？

**可能有用的空间特征**：

| 特征 | 描述 | 潜在价值 |
|------|------|----------|
| 脉搏波传播 | 血液从动脉传播到手指尖，不同位置有时间差 | 可推算 PTT (Pulse Transit Time) |
| 血管分布 | 指尖 vs 指根血管密度不同 | 信号强度空间分布 |
| 血流蔓延 | 每次心跳后"红色"如何蔓延 | 时空模式可能携带 ECG 信息 |

**当前实验结果**：

| 方案 | 保留空间信息？ | 效果 |
|------|---------------|------|
| Scheme C (MTTS-CAN) | ✅ 36×36 帧 | ❌ 不理想 |
| Scheme F (EfficientPhys) | ✅ 64×64 帧 | ❌ 不理想 |
| Scheme G (PhysNet 3D CNN) | ✅ 64×64 帧 | ❌ 不理想 |
| Scheme E (绿色通道均值) | ❌ 只有 1D | ❌ 不理想 |

**分析**：所有方案效果都不理想，说明问题可能不在于"是否保留空间信息"，而在于：
1. **模型设计目标错误**：现有模型（EfficientPhys/PhysNet）设计目标是 Video→rPPG（心率），不是 ECG 波形
2. **空间信息存在但没被正确利用**：需要专门为 Video→ECG 设计的空间特征提取器
3. **视频质量问题**：压缩（~275kbps）可能已破坏空间细节

### 10.2 多模态融合的潜在价值

| 模态 | 可能携带的信息 | 与 ECG 的关系 |
|------|--------------|--------------|
| **IMU** | 心跳引起的微小振动 (SCG/BCG) | 与 QRS 波有时间对应 |
| **音频** | 心音 (S1/S2) | S1≈QRS, S2≈T波结束 |
| **视频空间** | 脉搏波传播 | PTT 与血压相关 |

**物理基础**：
```
心跳过程中的多模态信号对应关系：

ECG:  ──P──QRS──T──
          │    │
          ▼    ▼
心音:     S1   S2    ← 瓣膜开关的声音
          │
          ▼
IMU:    振动峰值    ← 心室收缩引起的胸腔振动
          │
          ▼
PPG:   ~50-100ms后  ← 血液到达手指的延迟
```

**挑战**：多模态融合与模型验证需要同时进行，增加归因难度。

### 10.3 控制变量的实验设计

为了明确问题来源，需要逐步控制变量：

```
Step 1: 验证 PPG→ECG 任务本身是否可行
        在 BIDMC（高质量接触式 PPG）上跑 PPG2ECG
        ✅ 成功 → 任务可行，继续
        ❌ 失败 → 模型/复现有问题
                │ 成功
                ▼
Step 2: 验证我们的 PPG 质量是否足够
        用绿色通道均值 + PPG2ECG
        ✅ 成功 → 简单方法就够
        ❌ 失败 → PPG 质量不够，需要改进
                │ 失败
                ▼
Step 3: 验证更好的 PPG 提取是否有帮助
        用 EfficientPhys 提取 rPPG + PPG2ECG
        ✅ 成功 → 需要神经网络提取 PPG
        ❌ 失败 → 瓶颈不在 PPG 提取
                │ 失败
                ▼
Step 4: 验证端到端 + 多模态
        Video + IMU + 音频 → 端到端模型
        ✅ 成功 → 需要多模态 + 端到端
        ❌ 失败 → 任务太难 or 数据质量根本不行
```

**判断逻辑总结**：
```python
if P0_success and P1_fail:
    问题 = "我们的 PPG 质量不够"
    下一步 = "用神经网络提取更好的 PPG，或重采集数据"

elif P0_fail:
    问题 = "模型复现有误 or PPG→ECG 任务本身太难"
    下一步 = "检查复现细节，或换 CardioGAN"

elif P2_success:
    结论 = "端到端视频就够了，不需要多模态"

elif P2_fail and P3_success:
    结论 = "IMU 提供了关键信息"

elif all_fail:
    结论 = "任务太难 or 数据质量根本不行"
    下一步 = "降低任务难度（预测心率），或重新采集高质量数据"
```

---

## 附录：当前数据质量统计

```
总样本数: 98
质量分布:
  good: 80 (81.6%) - HR误差 ≤10 BPM
  moderate: 8 (8.2%) - HR误差 10-20 BPM
  poor: 10 (10.2%) - HR误差 >20 BPM（建议排除）

视频特征:
  平均码率: 289 kbps
  红色通道 std 平均: 2.45
  红色通道 range 平均: 15.3

问题用户:
  czq: 31% poor rate（可能采集问题）
```
